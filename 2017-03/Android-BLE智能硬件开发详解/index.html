<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Android:BLE智能硬件开发详解 | MichaelX&#39;s Blog | MichaelX的开发博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="BLE,智能硬件,Android">
    <meta name="description" content="前些年，智能硬件炒的挺火的，那今天，咱就来说说智能硬件那些事">
<meta name="keywords" content="BLE,智能硬件,Android">
<meta property="og:type" content="article">
<meta property="og:title" content="Android:BLE智能硬件开发详解">
<meta property="og:url" content="http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/index.html">
<meta property="og:site_name" content="MichaelX&#39;s Blog">
<meta property="og:description" content="前些年，智能硬件炒的挺火的，那今天，咱就来说说智能硬件那些事">
<meta property="og:updated_time" content="2017-05-03T08:21:21.752Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android:BLE智能硬件开发详解">
<meta name="twitter:description" content="前些年，智能硬件炒的挺火的，那今天，咱就来说说智能硬件那些事">
    
        <link rel="alternative" href="/atom.xml" title="MichaelX&#39;s Blog" type="application/atom+xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.4.7">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">MichaelX</h5>
          <a href="mailto:QQ:1692475028" title="QQ:1692475028" class="mail">QQ:1692475028</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/xiong-it" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://blog.csdn.net/xiong_it" target="_blank" >
                <i class="icon icon-lg icon-link"></i>
                CSDN
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Android:BLE智能硬件开发详解</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Android:BLE智能硬件开发详解</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-03-14T03:23:18.000Z" itemprop="datePublished" class="page-time">
  2017-03-14
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a></li></ul>

            
        </h5>
    </div>

    

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#目录"><span class="post-toc-number">1.</span> <span class="post-toc-text">目录</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#前言"><span class="post-toc-number">2.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#BLE是个什么鬼"><span class="post-toc-number">3.</span> <span class="post-toc-text">BLE是个什么鬼</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#角色分工"><span class="post-toc-number">4.</span> <span class="post-toc-text">角色分工</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#主要的关键词和概念"><span class="post-toc-number">5.</span> <span class="post-toc-text">主要的关键词和概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GATT-Generic-Attribute-Profile"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">GATT(Generic Attribute Profile )</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Characteristic"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">Characteristic</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Service"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">Service</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Android如何使用BLE"><span class="post-toc-number">6.</span> <span class="post-toc-text">Android如何使用BLE</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#蓝牙权限"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">蓝牙权限</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP和BLE外设交互流程"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">APP和BLE外设交互流程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#初始化BLE"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">初始化BLE</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP扫描周边BLE外设"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">APP扫描周边BLE外设</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP连接周边BLE外设"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">APP连接周边BLE外设</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP读取BLE外设蓝牙数据"><span class="post-toc-number">6.6.</span> <span class="post-toc-text">APP读取BLE外设蓝牙数据</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP向BLE外设写入数据"><span class="post-toc-number">6.7.</span> <span class="post-toc-text">APP向BLE外设写入数据</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP关闭蓝牙连接"><span class="post-toc-number">6.8.</span> <span class="post-toc-text">APP关闭蓝牙连接</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#后记"><span class="post-toc-number">7.</span> <span class="post-toc-text">后记</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考链接"><span class="post-toc-number">8.</span> <span class="post-toc-text">参考链接</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-Android-BLE智能硬件开发详解"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Android:BLE智能硬件开发详解</h1>
        <div class="post-meta">
            <time class="post-time" title="2017年03月14日 11:23" datetime="2017-03-14T03:23:18.000Z"  itemprop="datePublished">2017-03-14</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>前些年，智能硬件炒的挺火的，那今天，咱就来说说<strong>智能硬件那些事</strong><br><a id="more"></a></p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li><strong>前言</strong></li>
<li><strong>BLE是个什么鬼</strong></li>
<li><strong>BLE中的角色分工</strong></li>
<li><strong>主要的关键词和概念</strong><ul>
<li>GATT(Generic Attribute Profile )</li>
<li>Characteristic</li>
<li>Service</li>
</ul>
</li>
<li><strong>Android如何使用BLE</strong><ul>
<li>蓝牙权限</li>
<li>APP和BLE外设交互流程</li>
</ul>
</li>
<li><strong>后记</strong><br><br></li>
</ul>
<blockquote>
<p>本文作者MichaelX，博客地址：<a href="http://blog.csdn.net/xiong_it" target="_blank" rel="external">http://blog.csdn.net/xiong_it</a> 转载请注明来源</p>
</blockquote>
<hr>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>前些年，智能硬件炒的挺火的，那今天，咱就来说说<strong>智能硬件那些事</strong>。BLE是智能硬件的一种通讯方式，通过BLE连接，iOS &amp; Android手机和智能硬件就可以进行自定义的交互了。交互的体验如何，很大程度上取决于智能硬件的驱动工程师驱动写的好不好，以及App的代码质量如何。</p>
<p>笔者曾参与过多款BLE智能硬件的开发，许久不用，怕忘了，把自己的整理的一些知识记录与此，同时也希望能够给一些同学带来帮助。本文将尽力向读者讲清楚BLE是什么，以及在实际Android开发中该如何使用BLE。</p>
<p><strong>前方高能：</strong>文章有点长，笔者经历了好几次改版，也花费了好几个月的业余时间，读者可能需要点耐心。着急的读者可直接跳转至<strong><a href="http://blog.csdn.net/Xiong_IT/article/details/60966458#t8" target="_blank" rel="external">Android如何使用BLE</a></strong></p>
<h1 id="BLE是个什么鬼"><a href="#BLE是个什么鬼" class="headerlink" title="BLE是个什么鬼"></a>BLE是个什么鬼</h1><p>BLE：Bluetooth Low Energy,低功耗蓝牙。Android官方介绍如下：</p>
<blockquote>
<p>Android 4.3 (API Level 18) introduces built-in platform support for Bluetooth Low Energy in the central role and provides APIs that apps can use to discover devices, query for services, and read/write characteristics. In contrast to Classic Bluetooth, Bluetooth Low Energy (BLE) is designed to provide significantly lower power consumption. This allows Android apps to communicate with BLE devices that have low power requirements, such as proximity sensors, heart rate monitors, fitness devices, and so on.</p>
</blockquote>
<p>什么意思呢？自从API18/Android4.3开始，Android开始支持低功耗蓝牙并给APP提供了一套api调用。相比传统蓝牙来说，BLE技术旨在降低蓝牙功耗。至于我们Android开发者来说，要做的就是调用这套api，和具备蓝牙的智能硬件沟通，通过蓝牙读写操控智能硬件。</p>
<p>BLE技术允许APP和那些有着<strong>低功耗</strong>需求的BLE设备进行通讯，这些设备包括但不限于：距离传感器设备，心跳率检测仪，健身器材，智能穿戴等。</p>
<blockquote>
<p><strong>约定:文中提到的”外设”,”BLE外设”和”智能硬件”是等价的.请读者知悉.</strong></p>
</blockquote>
<hr>
<h1 id="角色分工"><a href="#角色分工" class="headerlink" title="角色分工"></a>角色分工</h1><blockquote>
<p>Once the phone and the activity tracker have established a connection, they start transferring GATT metadata to one another. Depending on the kind of data they transfer, one or the other might act as the server. For example, if the activity tracker wants to report sensor data to the phone, it might make sense for the activity tracker to act as the server. If the activity tracker wants to receive updates from the phone, then it might make sense for the phone to act as the server.</p>
</blockquote>
<p>在Android APP和BLE外设进行交互时,他们分别扮演两个角色.这两个角色是不固定的.<br>GATT server:发送数据的一方.<br>GATT client:接收数据的一方.<br>当APP向外设写入数据时,APP就是server,外设就是client;当APP读取外设数据时,APP就是client.外设就是server.</p>
<hr>
<h1 id="主要的关键词和概念"><a href="#主要的关键词和概念" class="headerlink" title="主要的关键词和概念"></a>主要的关键词和概念</h1><h2 id="GATT-Generic-Attribute-Profile"><a href="#GATT-Generic-Attribute-Profile" class="headerlink" title="GATT(Generic Attribute Profile )"></a>GATT(Generic Attribute Profile )</h2><blockquote>
<p>The GATT profile is a general specification for sending and receiving short pieces of data known as “attributes” over a BLE link. All current Low Energy APPlication profiles are based on GATT.</p>
</blockquote>
<p>这个是BLE通讯的基本协议,这个协议定义了BLE发送和接收一小段数据的规范,这些被传输的小段数据被称为”attributes”.</p>
<h2 id="Characteristic"><a href="#Characteristic" class="headerlink" title="Characteristic"></a>Characteristic</h2><blockquote>
<p>A characteristic contains a single value and 0-n descriptors that describe the characteristic’s value. A characteristic can be thought of as a type, analogous to a class. </p>
</blockquote>
<p>博主的理解中,”Characteristic”是BLE通讯之间的沟通”搬运工”,因为这是我们从智能硬件直接读写的东西,它依附于下文的Service存在，有自己的标志码：uuid。它『<strong>分为读取BLE外设数据的Characteristic &amp; 向BLE外设写入数据的Characteristic</strong>』。<br>下面章节中将用代码说话.</p>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><blockquote>
<p>A service is a collection of characteristics. For example, you could have a service called “Heart Rate Monitor” that includes characteristics such as “heart rate measurement.” </p>
</blockquote>
<p>此Service非彼Android四大组件中的彼Service,而是BluetoothGattService.这个Service是一个characteristics的集合,它可以理解为针对某个信号的通讯线路。</p>
<hr>
<h1 id="Android如何使用BLE"><a href="#Android如何使用BLE" class="headerlink" title="Android如何使用BLE"></a>Android如何使用BLE</h1><h2 id="蓝牙权限"><a href="#蓝牙权限" class="headerlink" title="蓝牙权限"></a>蓝牙权限</h2><p>使用BLE需要两个权限</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH_ADMIN"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>如果你想要APP只适配具备BLE的手机,那个可以再添加一个硬件权限特性<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:name</span>=<span class="string">"android.hardware.bluetooth_le"</span> <span class="attr">android:required</span>=<span class="string">"true"</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<h2 id="APP和BLE外设交互流程"><a href="#APP和BLE外设交互流程" class="headerlink" title="APP和BLE外设交互流程"></a>APP和BLE外设交互流程</h2><p>APP和BLE外设交互的一个大概流程就是:</p>
<ol>
<li>BLE外设打开电源</li>
<li>APP初始化蓝牙</li>
<li>APP扫描周边BLE外设</li>
<li>APP连接到周边BLE外设</li>
<li>APP读写BLE外设</li>
<li>交互完成,APP向BLE外设写入关机/待机指令(可选)</li>
<li>BLE外设关机</li>
<li>APP关闭本地蓝牙连接</li>
</ol>
<p>以下将逐步利用代码进行讲解APP和BLE外设交互.</p>
<h2 id="初始化BLE"><a href="#初始化BLE" class="headerlink" title="初始化BLE"></a>初始化BLE</h2><p>Java代码判断当前手机是否支持BLE低功耗蓝牙<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 判断手机是否支持BLE</span></div><div class="line"><span class="keyword">if</span> (!getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE)) &#123;</div><div class="line">    Toast.makeText(<span class="keyword">this</span>, R.string.ble_not_supported, Toast.LENGTH_SHORT).show();</div><div class="line">    finish();<span class="comment">// 如果手机不支持BLE就关闭程序,仅供参考</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>初始化蓝牙管理者和适配器,这2个对象是ble通讯的基石.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 初始化蓝牙管理者和适配器,这2个对象是ble通讯的基石.</span></div><div class="line"><span class="keyword">private</span> BluetoothAdapter mBluetoothAdapter;</div><div class="line">...</div><div class="line"><span class="keyword">final</span> BluetoothManager bluetoothManager =</div><div class="line">        (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);</div><div class="line">mBluetoothAdapter = bluetoothManager.getAdapter();</div></pre></td></tr></table></figure></p>
<p>跳转到系统蓝牙设置界面<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> BluetoothAdapter mBluetoothAdapter;</div><div class="line">...</div><div class="line"><span class="comment">// 验证蓝牙是否已打开,如果没打开就提示用户跳转打开.</span></div><div class="line"><span class="keyword">if</span> (mBluetoothAdapter == <span class="keyword">null</span> || !mBluetoothAdapter.isEnabled()) &#123;</div><div class="line">    Intent enableBtIntent = <span class="keyword">new</span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);</div><div class="line">    startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT);</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="APP扫描周边BLE外设"><a href="#APP扫描周边BLE外设" class="headerlink" title="APP扫描周边BLE外设"></a>APP扫描周边BLE外设</h2><p>需要实现一个BluetoothAdapter.LeScanCallback回调接口，得到扫描结果。该接口只有一个回调方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @param device 被手机蓝牙扫描到的BLE外设实体对象</div><div class="line"> * @param rssi 大概就是表示BLE外设的信号强度，如果为0，则表示BLE外设不可连接。</div><div class="line"> * @param scanRecord 被扫描到的BLE外围设备提供的扫描记录，一般没什么用</div><div class="line"> */</div><div class="line">public void onLeScan(final BluetoothDevice device, int rssi, byte[] scanRecord)</div></pre></td></tr></table></figure></p>
<p>由于扫描BLE设备比较消耗资源，官方推荐间歇性扫描，示例代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">    private BluetoothAdapter mBluetoothAdapter;</div><div class="line">    private boolean mScanning;</div><div class="line">    private Handler mHandler;</div><div class="line"></div><div class="line">    // 每扫描10s休息一下</div><div class="line">    private static final long SCAN_PERIOD = 10000;</div><div class="line">    </div><div class="line">    private BluetoothAdapter.LeScanCallback mLeScanCallback =</div><div class="line">        new BluetoothAdapter.LeScanCallback() &#123;</div><div class="line">    @Override</div><div class="line">    public void onLeScan(final BluetoothDevice device, int rssi, byte[] scanRecord) &#123;</div><div class="line">            // TODO 这里可以进行连接操作，连接操作见下一小节</div><div class="line">            if (device != null &amp;&amp; device.getName() != null &amp;&amp; device.getName().contain(&quot;你的产品名称&quot;))&#123;</div><div class="line">                // 连接设备</div><div class="line">                connectDevice(device);</div><div class="line">                // 停止扫描</div><div class="line">                scanLeDevice(false);</div><div class="line">            &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line">   &#125;</div><div class="line">&#125;;</div><div class="line">    </div><div class="line">    ...</div><div class="line">    /**</div><div class="line">     * @param enable 是否进行扫描，false则停止扫描</div><div class="line">     */</div><div class="line">    private void scanLeDevice(final boolean enable) &#123;</div><div class="line">        if (enable) &#123;</div><div class="line">            // 利用Handler进行间歇性扫描，每次扫描时间：10s</div><div class="line">            mHandler.postDelayed(new Runnable() &#123;</div><div class="line">                @Override</div><div class="line">                public void run() &#123;</div><div class="line">                    mScanning = false;</div><div class="line">                    mBluetoothAdapter.stopLeScan(mLeScanCallback);</div><div class="line">                &#125;</div><div class="line">            &#125;, SCAN_PERIOD);</div><div class="line"></div><div class="line">            mScanning = true;</div><div class="line">            mBluetoothAdapter.startLeScan(mLeScanCallback);</div><div class="line">        &#125; else &#123;</div><div class="line">            // 停止扫描</div><div class="line">            mScanning = false;</div><div class="line">            mBluetoothAdapter.stopLeScan(mLeScanCallback);</div><div class="line">        &#125;</div><div class="line">        ...</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="APP连接周边BLE外设"><a href="#APP连接周边BLE外设" class="headerlink" title="APP连接周边BLE外设"></a>APP连接周边BLE外设</h2><p>连接操作是进行手机和BLE外设交互的基础，请看下面connectDevice(BluetoothDevice)方法实现。</p>
<p>分两步走：</p>
<ol>
<li>判断该设备是否连接过，连接过则首先尝试直接连接：BluetoothGatt.connect()</li>
<li>首次连接或者直连失败使用：BluetoothDevice.connectGatt(Context context, boolean autoConnect, BluetoothGattCallback callback)<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connectDevice</span><span class="params">(<span class="keyword">final</span> BluetoothDevice device)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (mBluetoothAdapter == <span class="keyword">null</span> || device == <span class="keyword">null</span>) &#123;</div><div class="line">			Log.w(TAG,</div><div class="line">					<span class="string">"BluetoothAdapter not initialized or unspecified address."</span>);</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">        </div><div class="line">        String address = device.getAddress();</div><div class="line">		<span class="comment">// 之前连接过的设备，尝试直接连接。mBluetoothDeviceAddress表示刚才连接过的设备地址</span></div><div class="line">		<span class="keyword">if</span> (mBluetoothDeviceAddress != <span class="keyword">null</span></div><div class="line">				&amp;&amp; address.equals(mBluetoothDeviceAddress)</div><div class="line">				&amp;&amp; mBluetoothGatt != <span class="keyword">null</span>) &#123;</div><div class="line">			Log.d(TAG,</div><div class="line">					<span class="string">"Trying to use an existing mBluetoothGatt for connection."</span>);</div><div class="line">			<span class="keyword">if</span> (mBluetoothGatt.connect()) &#123;<span class="comment">// 连接成功</span></div><div class="line">			    <span class="comment">// 修改连接状态变量</span></div><div class="line">				mConnectionState = STATE_CONNECTING;</div><div class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">final</span> BluetoothDevice remoteDevice = mBluetoothAdapter.getRemoteDevice(address);</div><div class="line">		<span class="keyword">if</span> (remoteDevice == <span class="keyword">null</span>) &#123;</div><div class="line">			Log.w(TAG, <span class="string">"Device not found.  Unable to connect."</span>);</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">		mBluetoothGatt = remoteDevice.connectGatt(context, <span class="keyword">false</span>, mGattCallback);</div><div class="line">		Log.d(TAG, <span class="string">"Trying to create a new connection."</span>);</div><div class="line">		<span class="comment">// 将当前连接上的设备地址赋值给连接过的设备地址变量</span></div><div class="line">		mBluetoothDeviceAddress = address;</div><div class="line">		<span class="comment">// 改变连接状态变量</span></div><div class="line">		mConnectionState = STATE_CONNECTING;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>连接BEL外设时，需要一个实现回调接口以得到连接状态，BluetoothGattCallback大概实现如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">private final BluetoothGattCallback mGattCallback =</div><div class="line">            new BluetoothGattCallback() &#123;</div><div class="line">        @Override</div><div class="line">        public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) &#123;</div><div class="line">            // 该方法在连接状态改变时回调，newState即代表当前连接状态</div><div class="line">            String intentAction;</div><div class="line">            // 连接上了</div><div class="line">            if (newState == BluetoothProfile.STATE_CONNECTED) &#123;</div><div class="line">                intentAction = ACTION_GATT_CONNECTED;</div><div class="line">                // 改变蓝牙连接状态变量</div><div class="line">                mConnectionState = STATE_CONNECTED;</div><div class="line">                // 发送自定义广播：连接上了</div><div class="line">                broadcastUpdate(intentAction);</div><div class="line">                // 当前外设相当于前面章节提到的Server角色：提供数据被手机读取</div><div class="line">                Log.i(TAG, &quot;Connected to GATT server.&quot;);</div><div class="line">                // 获取读/写服务：Service。该方法会触发下面的onServicesDiscovered()回调</div><div class="line">                mBluetoothGatt.discoverServices();</div><div class="line"></div><div class="line">            &#125; else if (newState == BluetoothProfile.STATE_DISCONNECTED) &#123;// 断开连接了</div><div class="line">                intentAction = ACTION_GATT_DISCONNECTED;</div><div class="line">                mConnectionState = STATE_DISCONNECTED;</div><div class="line">                Log.i(TAG, &quot;Disconnected from GATT server.&quot;);</div><div class="line">                // 发送自定义广播：断开了连接</div><div class="line">                broadcastUpdate(intentAction);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        // 该方法在蓝牙服务被发现时回调。由上述的mBluetoothGatt.discoverServices()触发结果。</div><div class="line">        public void onServicesDiscovered(BluetoothGatt gatt, int status) &#123;</div><div class="line">            // 发现服务。status表示发现服务的结果码</div><div class="line">            if (status == BluetoothGatt.GATT_SUCCESS) &#123;</div><div class="line">                broadcastUpdate(ACTION_GATT_SERVICES_DISCOVERED);</div><div class="line">                // TODO 从发现的Service来找出读数据用的BluetoothGattCharacteristic和写数据用的BluetoothGattCharacteristic。</div><div class="line">                initReadAndWriteCharacteristic(gatt.getServices());</div><div class="line">                </div><div class="line">            &#125; else &#123;// 未发现服务</div><div class="line">                Log.w(TAG, &quot;onServicesDiscovered received: &quot; + status);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        // 读取操作的回调结果</div><div class="line">        public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) &#123;</div><div class="line">            if (status == BluetoothGatt.GATT_SUCCESS) &#123;</div><div class="line">                broadcastUpdate(ACTION_DATA_AVAILABLE, characteristic);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        @Override</div><div class="line">        // 写入操作的回调结果</div><div class="line">        public void onCharacteristicWrite(BluetoothGatt gatt,</div><div class="line">				BluetoothGattCharacteristic characteristic, int status) &#123;</div><div class="line">		&#125;;</div><div class="line">     ...</div><div class="line">    &#125;;</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p><br><br><strong>找出读写”数据包”的”搬运工”</strong></p>
<p>下面是找出读写”搬运工”BluetoothGattCharacteristic的initReadAndWriteCharacteristic()代码实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">BluetoothGattCharacteristic mReadCharacteristic;</div><div class="line">BluetoothGattCharacteristic mWriteCharacteristic;</div><div class="line"></div><div class="line">public void initReadAndWriteCharacteristic(</div><div class="line">			List&lt;BluetoothGattService&gt; gattServices) &#123;</div><div class="line">		if (gattServices == null)</div><div class="line">			return;</div><div class="line">		// 遍历所有的 GATT Services.</div><div class="line">		for (BluetoothGattService gattService : gattServices) &#123;</div><div class="line">			if (!gattService.getUuid().toString().trim().equalsIgnoreCase(&quot;这里是你期望的Service的uuid，由你司智能外色的驱动工程师决定&quot;))</div><div class="line">			    continue;</div><div class="line">			List&lt;BluetoothGattCharacteristic&gt; gattCharacteristics = gattService.getCharacteristics();</div><div class="line">			// 遍历当前Service中所有的Characteristics.</div><div class="line">			for (BluetoothGattCharacteristic gattCharacteristic : gattCharacteristics) &#123;</div><div class="line"></div><div class="line">				if (gattCharacteristic.getUuid().toString().trim().equalsIgnoreCase(&quot;&quot;这里是你期望的写数据的uuid，由你司驱动工程师决定&quot;&quot;)) &#123;</div><div class="line">					mWriteCharacteristic = gattCharacteristic;</div><div class="line">				&#125; else if (gattCharacteristic.getUuid().toString().trim().equalsIgnoreCase(&quot;这里是你期望的读数据的uuid，由你司驱动工程师决定&quot;)) &#123;</div><div class="line">					mReadCharacteristic = gattCharacteristic;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>至此，我们就拿到了可携带读写数据的“搬运工”-『<strong>mReadCharacteristic  &amp; mWriteCharacteristic</strong>』，下面就可以和智能硬件进行交互了。<br><br></p>
<h2 id="APP读取BLE外设蓝牙数据"><a href="#APP读取BLE外设蓝牙数据" class="headerlink" title="APP读取BLE外设蓝牙数据"></a>APP读取BLE外设蓝牙数据</h2><p>想要读取BLE外设的数据时，比如：心跳速率，电量等等。可通过下面方式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// 告诉”搬运工“我想知道BLE外设当前数据,将回调BluetoothGattCallback接口的onCharacteristicRead()方法</div><div class="line">mBluetoothGatt.readCharacteristic(mReadCharacteristic);</div><div class="line"></div><div class="line">// 读取BLE蓝牙数据操作的回调方法</div><div class="line"> @Override</div><div class="line">public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) &#123;</div><div class="line">            if (status == BluetoothGatt.GATT_SUCCESS) &#123;</div><div class="line">                broadcastUpdate(ACTION_DATA_AVAILABLE, characteristic);</div><div class="line">                // ”搬运工“把”数据包“搬出来了</div><div class="line">                byte[] data = characteristic.getValue();</div><div class="line">		        // 根据驱动工程师给的协议文档，解析该数组，该处假设数组0位上表示心跳速率</div><div class="line">		        int heartRateR = data[0];// 得到心跳速率，做相应UI更新和操作</div><div class="line">		&#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="APP向BLE外设写入数据"><a href="#APP向BLE外设写入数据" class="headerlink" title="APP向BLE外设写入数据"></a>APP向BLE外设写入数据</h2><p>比如说你想告诉BLE外设让他锁屏，或者进行某个动作，APP向操纵BLE外设时可通过以下方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// 根据驱动工程师给的协议文档，组织一个数组命令</div><div class="line">byte[] data = getData();</div><div class="line">// 将该条命令“数据包”给“搬运工&quot;</div><div class="line">mWriteCharacteristic.setValue(data);</div><div class="line"></div><div class="line">// ”搬运工“将数据搬到BLE外设里面了，将回调BluetoothGattCallback接口的onCharacteristicWrite()方法</div><div class="line">mBluetoothGatt.writeCharacteristic(characteristic);</div><div class="line"></div><div class="line">// 向BLE蓝牙外设写入数据操作的回调方法</div><div class="line">@Override</div><div class="line">public void onCharacteristicWrite(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) &#123;</div><div class="line">			if(status == BluetoothGatt.GATT_SUCCESS) &#123;</div><div class="line">			    // 命令写入成功，数据包成功写入BLE外设中</div><div class="line">			&#125;	</div><div class="line">		&#125;;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>多说一句，其实，手机关闭外设也是一条写入命令，外设得到该命令后即进入省电待机状态，一般外设也可以通过开/关机键彻底关机。</p>
</blockquote>
<p><br></p>
<h2 id="APP关闭蓝牙连接"><a href="#APP关闭蓝牙连接" class="headerlink" title="APP关闭蓝牙连接"></a>APP关闭蓝牙连接</h2><p>交互完了，不需要了，还是把APP蓝牙连接给断掉吧<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public void close() &#123;</div><div class="line">    if (mBluetoothGatt == null) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    mBluetoothGatt.close();</div><div class="line">    mBluetoothGatt = null;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>Android官方在SDK中提供了许多demo供开发者参考（1年前左右），其实关于BLE api调用也是有的,不过只涉及了蓝牙外设的连接,未涉及蓝牙数据读写.BLE官方demo路径:<code>User/AndroidSDK/samples/android-19/connectivity/BluetoothLeGatt</code><br>以上路径是笔者举例的路径,如果你的SDK目录下没有samples目录，现在（20170308）SDK Manager已经不开放sample下载了,请点击下载：<a href="https://pan.baidu.com/s/1o87ASJK" target="_blank" rel="external">android-sample-api19</a> 文件提取密码: y87g</p>
<blockquote>
<p>本文原创作者:<a href="http://blog.csdn.net/xiong_it" target="_blank" rel="external">MichaelX</a>,博客地址:<a href="http://blog.csdn.net/xiong_it.转载请注明来源" target="_blank" rel="external">http://blog.csdn.net/xiong_it.转载请注明来源</a></p>
</blockquote>
<p>欢迎光临：<a href="https://xiong-it.github.io" target="_blank" rel="external">MichaelX’s Blog</a></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://developer.android.com/guide/topics/connectivity/bluetooth-le.html#terms" target="_blank" rel="external">https://developer.android.com/guide/topics/connectivity/bluetooth-le.html#terms</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-05-03T08:21:21.752Z" itemprop="dateUpdated">2017年5月3日 16:21</time>
</span><br>


        版权声明：本文为博主原创文章，转载请注明出处：<a href="/2017-03/Android-BLE智能硬件开发详解/" target="_blank" rel="external">http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/</a>
    </div>
    <footer>
        <a href="http://blog.michaelx.tech">
            <img src="/img/avatar.jpg" alt="MichaelX">
            MichaelX
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BLE/">BLE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/智能硬件/">智能硬件</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&title=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&pic=http://blog.michaelx.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&title=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&source=前些年，智能硬件炒的挺火的，那今天，咱就来说说智能硬件那些事" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&via=http://blog.michaelx.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017-03/Ubuntu-14-04编译AOSP-for-Nexus-Pixel/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Ubuntu 14.04编译AOSP for Nexus/Pixel</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017-02/Design-Patterns-in-Android：模板方法模式/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Design Patterns in Android：模板方法模式</h4>
      </a>
    </div>
  
</nav>



    








</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            <span>博客内容遵循 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>MichaelX's Blog &copy; 2017</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&title=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&pic=http://blog.michaelx.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&title=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&source=前些年，智能硬件炒的挺火的，那今天，咱就来说说智能硬件那些事" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android:BLE智能硬件开发详解》 — MichaelX's Blog&url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/&via=http://blog.michaelx.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.michaelx.tech/2017-03/Android-BLE智能硬件开发详解/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACrElEQVR42u3aQW7kMAwEwPz/01lgrwtPuilxJguUT0HgyCofTKapr6/4+v57vf65vfP1Cv/+7dMKFy48PDy80dafrqd7ngCzO2ev+PUT8fDw8LZ5+XJ5ech/n7zEWZnBw8PD+ywvaXzzdrltmvHw8PD+X97JJpLP/ex14+Hh4b2fdxIltE3wLLpdz1rw8PDwYt6tAdg7f/7AfA8PDw8v+LyehKp569w+pdgtHh4e3gIvPxaQD7cS3mwklleBYqqGh4eHV/LyRvY8qrgVEOd7wMPDw/sUL2+ab32N80L1QyOOh4eHt8xLmtQ2kmiz1tlTHu/Bw8PDW+Dl//CffPqTyKNtyouoAg8PD2+Bd/LJTtrukxWSuHlIxcPDwzvgte48os1D2DxiqEsFHh4e3lVePpJvHz8MDsrg+IdXjIeHh7fAi8ZIQSSRHzJoY4uT0oKHh4e3x8vb39mLyItE28TPDm/h4eHh3eLdCgtOBmZt65xHJHh4eHi3eO2iSUloA4u7RxMesxY8PDy8q7yThngWXmxEvY+FAQ8PD2+Nl4cFScCaj9POD109Ph0PDw9vgTfbYh7Ctk35bPAW7QoPDw/vKu/1RzZvZ2dl42QAFl14eHh4V3ntgYDZgOqoFR6VIjw8PLw9XlsYki0mpaUtFbP94OHh4W3w8gA3H0e1g6vZYYUIjIeHh/cWXlsGWvyt9CAKNfDw8PAWeK+XvrXRdrh1lEnj4eHhLfO+y2sWsM7WuVCW8PDw8BZ4s+MFbXnIS0VSNmYHFPDw8PDu8up4NB5i5WP+jWMKeHh4eNu82eNPAoi2tAyLFh4eHt5Hee0BqRaZFKf6sAIeHh7eL+OdHDg4GYMVT8HDw8Nb483CiDwyyMdXeWmJygMeHh7eAu9kAHbyCtrNtcUGDw8Pb4H3Bxr1IhYTqkacAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };



</script>

<script src="/js/main.min.js?v=1.4.7"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.4.7" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</body>
</html>
